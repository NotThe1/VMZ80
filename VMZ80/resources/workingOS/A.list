0001: 0100         ; A.Z80
0002: 0100         ; 8
0003: 0100             BDOS       EQU    00005H
0004: 0100             OPEN_FILE  EQU    0FH
0005: 0100             CLOSE_FILE EQU    10H
0006: 0100             FIND_FIRST EQU    11H
0007: 0100             FIND_NEXT  EQU    12H
0008: 0100             READ_SEQ   EQU    14H
0009: 0100             RENAME_FILE EQU    17H
0010: 0100             SET_DMA    EQU    1AH
0011: 0100             GET_SIZE   EQU    023H
0012: 0100             SET_RANDREC EQU    024H
0013: 0100             defaultBuffer EQU    080H
0014: 0100
0015: 0100             recordRandom EQU    20 + 1               ; Random record field (2 bytes)
0016: 0100             recordRandomLSB EQU    recordRandom         ; LSB of Random Record
0017: 0100             recordRandomMSB EQU    recordRandom + 1     ; MSB of Random Record
0018: 0100             recordRandomOVF EQU    recordRandom + 2     ; Random Record Overflow
0019: 0100
0020: 0100             TPA        EQU    0100H
0021: 0100
0022: 0100                        ORG    TPA
0023: 0100             Start:
0024: 0100
0025: 0100 DD 09                  ADD    IX,BC
0026: 0102 DD 19                  ADD    IX,DE
0027: 0104 DD 29                  ADD    IX,IX
0028: 0106 DD 39                  ADD    IX,SP
0029: 0108
0030: 0108 FD 09                  ADD    IY,BC
0031: 010A FD 19                  ADD    IY,DE
0032: 010C FD 29                  ADD    IY,IY
0033: 010E FD 39                  ADD    IY,SP
0034: 0110
0035: 0110
0036: 0110
0037: 0110
0038: 0110
0039: 0110
0040: 0110
0041: 0110 31 E7 02               LD     SP,Stack
0042: 0113 01 00 00               LD     BC,0000
0043: 0116 11 00 00               LD     DE,0000
0044: 0119 21 00 00               LD     HL,0000
0045: 011C DD 21 3D 01               LD     IX,cmdLine
0046: 0120             Loop1:
0047: 0120 DD 7E 00               LD     A,(IX+0)
0048: 0123 DD 23                  INC    IX
0049: 0125 FE 20                  CP     020H
0050: 0127 28 12                  JR     Z,END
0051: 0129 D6 30                  SUB    030H
0052: 012B FE 0A                  CP     0AH
0053: 012D 30 0C                  JR     NC,END
0054: 012F
0055: 012F 29                     ADD    HL,HL                ; * 2
0056: 0130 E5                     PUSH   HL                   ; save * 2
0057: 0131 29                     ADD    HL,HL                ; * 4
0058: 0132 29                     ADD    HL,HL                ; * 8
0059: 0133 D1                     POP    DE                   ; Get * 2
0060: 0134 19                     ADD    HL,DE                ; * 10
0061: 0135
0062: 0135 4F                     LD     C,A
0063: 0136 06 00                  LD     B,0
0064: 0138 09                     ADD    HL,BC                ; new value
0065: 0139 18 E5                  JR     Loop1
0066: 013B
0067: 013B             END:
0068: 013B 00                     NOP
0069: 013C 76                     HALT
0070: 013D
0071: 013D 32 35 35 20     cmdLine:   DB     '255 '
0072: 0141
0073: 0141
0074: 0141
0075: 0141             FCB:
0076: 0141
0077: 0141 00          DISK:      DB     00
0078: 0142 42 20 20 20 20 20 20 20     NAME:      DB     'B       '
0079: 014A 41 52 4B     TYPE:      DB     'ARK'
0080: 014D 00          EXT:       DB     0
0081: 014E 00 00       RESV:      DB     0,0
0082: 0150 00          RC:        DB     0
0083: 0151 00 00       ALLOC:     DW     0
0084: 0153 00 00                  DW     0
0085: 0155 00 00                  DW     0
0086: 0157 00 00                  DW     0
0087: 0159 00 00                  DW     0
0088: 015B 00 00                  DW     0
0089: 015D 00 00                  DW     0
0090: 015F 00 00                  DW     0
0091: 0161 00          REC_SEQ:   DB     0
0092: 0162 00 00       REC_RANDOM: DW     0000H
0093: 0164 00          REC_RAN_O: DB     00
0094: 0165
0095: 0165             erPermanent:
0096: 0165 00                     NOP
0097: 0166 76                     HALT
0098: 0167                        DS     0100H
0099: 0267 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0100: 0277 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0101: 0287 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0102: 0297 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0103: 02A7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0104: 02B7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0105: 02C7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0106: 02D7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                DB     0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
0107: 02E7             Stack:
0108: 02E7
0109: 02E7         ;DOLLARInclude ./HeaderForA.Z80
           ************************   Xref   ************************
0000: $               02D7
0083: ALLOC           0151
0003: BDOS            0005
0005: CLOSE_FILE      0010
0071: cmdLine         013D   0045
0013: defaultBuffer   0080
0077: DISK            0141
0067: END             013B   0050 0053
0095: erPermanent     0165
0080: EXT             014D
0075: FCB             0141
0006: FIND_FIRST      0011
0007: FIND_NEXT       0012
0011: GET_SIZE        0023
0046: Loop1           0120   0065
0078: NAME            0142
0004: OPEN_FILE       000F
0082: RC              0150
0008: READ_SEQ        0014
0093: REC_RAN_O       0164
0092: REC_RANDOM      0162
0091: REC_SEQ         0161
0015: recordRandom    0015   0016 0017 0018
0016: recordRandomLSB 0015
0017: recordRandomMSB 0016
0018: recordRandomOVF 0017
0009: RENAME_FILE     0017
0081: RESV            014E
0010: SET_DMA         001A
0012: SET_RANDREC     0024
0107: Stack           02E7   0041
0023: Start           0100
0020: TPA             0100   0022
0079: TYPE            014A
